{"componentChunkName":"component---src-templates-post-js","path":"/blog/2018/06/psa-arbitrary-file-deletion-vulnerability-in-all-current-versions-of-wordpress/","result":{"data":{"wordpressPost":{"id":"ac6f72d2-7fb0-5df8-8a34-262c80976872","wordpress_id":26332,"slug":"psa-arbitrary-file-deletion-vulnerability-in-all-current-versions-of-wordpress","path":"/blog/2018/06/psa-arbitrary-file-deletion-vulnerability-in-all-current-versions-of-wordpress/","author":[{"id":"5be72c28-6949-53f8-b212-3feb5a9983de","path":"gilzow","display_name":"Paul Gilzow","email":"gilzowp@missouri.edu","twitter":"gilzow","website":"http://missouri.edu/","company":"University of Missouri","company_position":"Programmer Analyst","bio":"Web application security and accessibility evangelist. Software instructor. Conference lecturer and presenter."}],"title":"PSA: Arbitrary File Deletion vulnerability in all current versions of WordPress","type":"post","status":"publish","date":"2018-06-27T14:53:58.000Z","dateFormatted":"June 27, 2018","excerpt":"<p>Update 20180705: version 4.9.7 has been released and addresses the issue below.  RipsTech (static analysis for PHP) yesterday disclosed an arbitrary file deletion vulnerability in all versions of WordPress.  The...</p>\n","content":"<p><strong>Update 20180705: version <a href=\"https://wordpress.org/news/2018/07/wordpress-4-9-7-security-and-maintenance-release/\">4.9.7 has been released</a> and addresses the issue below. </strong></p>\n<p class=\"p1\"><span class=\"s1\"><a href=\"https://www.ripstech.com/\">RipsTech</a> (static analysis for PHP) yesterday <a href=\"https://blog.ripstech.com/2018/wordpress-file-delete-to-code-execution/\">disclosed an arbitrary file deletion vulnerability in all versions of WordPress</a>.  <strong>The vulnerability </strong></span><span class=\"s1\"><strong>requires a role of Author or greater in order to exploit</strong>.  The exploit allows an authenticated user to delete any file on the server that the user account php runs under has access to.  A prime target for attackers will be the wp-config.php which will allow them to reinstall WordPress connected to a database they control. </span></p>\n<p class=\"p1\"><span class=\"s1\">The current suggested fix is to hook the `</span><span class=\"s2\"> <a href=\"https://developer.wordpress.org/reference/hooks/wp_update_attachment_metadata/\"><span class=\"s3\">wp_update_attachment_metadata</span></a></span><span class=\"s1\">` filter action, and pass the thumb parameter through the <a href=\"http://php.net/manual/en/function.basename.php\"><span class=\"s4\">basename function</span></a> so that only the filename is returned.  The following snippet of code can be added to your theme’s function file:</span></p>\n<pre>add_filter('wp_update_attachment_metadata', function ($aryPostData){\r\n    if (isset($aryPostData['thumb'])) {\r\n        $aryPostData['thumb'] = basename($aryPostData['thumb']);\r\n    }\r\n    \r\n    return $aryPostData;\r\n});\r\n</pre>\n<p class=\"p1\"><span class=\"s1\">Alternatively, the snippet can be made into a plugin and either activated, or dropped into your must-use plugins directory. </span></p>\n<p class=\"p1\"><span class=\"s1\">In addition, this a good reminder that you should audit your current user list and verify that every user on your site should have access, and that they have the appropriate roles assigned to them.  </span></p>\n","comment_status":"open","categories":[{"id":"2b3b6db2-5475-53a0-af10-92a53817aa73","wordpress_id":59,"count":114,"name":"Security","description":"","slug":"security"}],"wpc_seo":{"title":"","meta":{"description":"Update 20180705: version 4.9.7 has been released and addresses the issue below.  RipsTech (static analysis for PHP) yesterday disclosed an arbitrary file deletion vulnerability in all versions of WordPress.  The...","robots":[]}}},"site":{"siteMetadata":{"siteName":"WPCampus: Where WordPress meets higher education"}}},"pageContext":{"id":"ac6f72d2-7fb0-5df8-8a34-262c80976872","wpc_protected":null,"next":{"id":"d6788d0f-9477-5e67-9e4f-2a80a71f44a5","wordpress_id":26268,"slug":"meet-boldgrid-wpcampus-2018-sponsor","path":"/blog/2018/06/meet-boldgrid-wpcampus-2018-sponsor/","title":"Meet BoldGrid, WPCampus 2018 Sponsor","date":"2018-06-26T14:41:30.000Z","wpc_protected":null},"previous":{"id":"b979592b-def1-5ec7-8266-37e0436138b0","wordpress_id":26546,"slug":"meet-ddev-wpcampus-2018-sponsor","path":"/blog/2018/07/meet-ddev-wpcampus-2018-sponsor/","title":"Meet DDEV, WPCampus 2018 Sponsor","date":"2018-07-02T15:54:38.000Z","wpc_protected":null},"crumbs":{"crumb":{"path":"/blog/2018/06/psa-arbitrary-file-deletion-vulnerability-in-all-current-versions-of-wordpress/","text":"PSA: Arbitrary File Deletion vulnerability in all current versions of WordPress"},"parent_element":{"crumb":{"path":"/blog/","text":"Community Blog"}}}}},"staticQueryHashes":["2186475492"]}